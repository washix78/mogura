# mogura

ファイルおよびシンボリックリンクの探索・移動を行うツール群です。  
なおWindows環境へはまだ対応していません。  

`mogura`は"mole"の日本語です。  

* info: ファイルおよびシンボリックリンクの数や拡張子について出力します。
* unique: ファイルおよびシンボリックリンクを指定ディレクトリ以下で単一にします。
* extension: ファイルおよびシンボリックリンクを拡張子ごとに分けます。
* comp: あるディレクトリ以下のファイルおよびシンボリックリンクと重複しているものを移動します。

## ログファイル

各ツールはログファイルを出力します。  
出力先ディレクトリは`logs`です。  
ログファイルはJSON、名前は`${timestamp}_${tool name}_${sign}.json`の形式で出力します。

## 移動先ディレクトリ

`unique`、`comp`は、一部のファイルおよびシンボリックリンクを"移動先ディレクリ"へ移動することがあります。
"移動先ディレクトリ"は`extra`ディレクトリ以下に作成します。  
そのディレクトリ名の形式は`${timestamp}_${tool name}_${sign}`です。

## info

指定したディレクトリについて、以下を出力します。

* ファイル数
* シンボリックリンク数
* ファイルの拡張子とその拡張子を持つファイルの数
* シンボリックリンクの拡張子とその拡張子を持つシンボリックリンクの数

ファイルの拡張子は大文字で出力します。  
拡張子の長さが0の場合は`ext_zero.d`、拡張子が無い場合は`ext_none.d`として出力します。  

```
node info ${directory path} ${options}
```

### options

`${sign}`にはログファイルおよび抽出したファイルのディレクトリの名前に含みたい文字列を指定してください。  
指定した場合、ログファイル名は`${timestamp}_info_${sign}.json`になります。

```
-s ${sign}
```

## unique

対象ディレクトリ以下のファイルが対象ディレクトリ以下で単一になるよう、重複しているファイルおよびシンボリックリンクを"移動先ディレクトリ"へ移動します。  
対象ディレクトリ以下に参照先ファイルが無いシンボリックリンクは、1つを残して移動します。

```
node unique ${directory path} ${options}
```

"移動先ディレクトリ"以下には、名前がダイジェスト値であるディレクトリを作成し、そのディレクトリにファイルを移動します。  
移動後のファイル名の形式は`${type}${no}_${btime}-${name}`です。  
`${type}`が`0`ならばシンボリックリンクで、`1`ならばファイルです。  
ただし`${type}`が`1`で`${no}`がすべて`0`は、ファイルです。  

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。  

### options

`${sign}`にはログファイルおよび抽出したファイルのディレクトリの名前に含みたい文字列を指定してください。
指定した場合、ログファイル名は`${timestamp}_unique_${sign}.json`になります。

```
-s ${sign}
```

実際に重複しているファイルおよびシンボリックリンクを除く場合は指定してください。

```
-F
```

## extension

指定したディレクトリ以下に次のディレクトリを作成します。

* 拡張子を大文字にした名前のディレクトリ
* `ext_none.d`という名前のディレクトリ
* `ext_zero.d`という名前のディレクトリ

1文字以上の拡張子を持つファイルおよびシンボリックリンクは、その拡張子を大文字にした名前のディレクトリに移動します。  
拡張子の長さが0のファイルおよびシンボリックリンクは、`ext_zero.d`という名前のディレクトリに移動します。  
拡張子が無いファイルおよびシンボリックリンクは、`ext_none.d`という名前のディレクトリに移動します。  
指定したディレクトリ以下に存在するディレクトリは、"移動先ディレクトリ"以下の`extra.d`ディレクトリへ移動します。  

```
node extension ${directory path} ${options}
```

ファイルは`${type}${no}_${btime}-${name}`という形式の名前になります。
ファイルをファイル名の昇順で並べ替えると、シンボリックリンク、ファイルの順になります。
`${no}`はシンボリックリンクとファイルそれぞれで`${btime}`が小さい順に`0`からの番号になります。
`${type}`が`0`の場合はシンボリックリンクで、`1`の場合はファイルです。

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。

### options

```
-s ${sign}
```

実際にファイルおよびシンボリックリンクを移動する場合は、`-F`を指定します。

```
-F
```

## comp

基準ディレクトリ以下のファイルと重複している対象ディレクトリ以下のファイルおよびシンボリックリンクを対象ディレクトリから移動します。  
基準ディレクトリ以下のシンボリックリンクと重複している対象ディレクトリ以下のシンボリックリンクを対象ディレクトリから移動します。  
基準ディレクトリ以下の参照先ファイルが無いシンボリックリンクと重複している対象ディレクトリ以下のファイルは対象ディレクトリ以下から移動しません。  

```
node comp ${base directory path} ${target directory path} ${options}
```

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。

### options

```
-s ${sign}
```

実際にファイルおよびシンボリックリンクを移動する場合は、`-F`を指定します。

```
-F
```
