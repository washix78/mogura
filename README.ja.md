# mogura

ファイルおよびシンボリックリンクの探索・移動を行うツール群です。  
`mogura`は"mole"の日本語です。  
WindowsのCLIで使う場合は管理者で実行してください。  

* info: ファイルおよびシンボリックリンクの数や拡張子について出力します。
* unique: ファイルを指定ディレクトリ以下で単一にします。
* extension: ファイルを拡張子ごとに分けます。
* comp: あるディレクトリ以下のファイルと重複しているファイルを移動します。
* supply: 対象ディレクトリ以下のファイルの内、基準ディレクトリ以下のファイルと不同のファイルを複製します。
* header: 指定したディレクトリ以下のファイルの最初の数バイトを出力します。
* image: 指定したディレクトリ以下のファイルをBMP、GIF、JPG、PNGかそれ以外かに分けます。
* date: 指定したディレクトリ以下のファイルを年月日で分けます。
* size: 指定したディレクトリ以下のファイルを画像かそうでないかに分け、画像である場合はさらにサイズで分けます。
* copy: 指定したディレクトリ以下にある条件に一致したファイルを他のディレクトリへ複製します。
* move: 指定したディレクトリ以下にある条件に一致したファイルを他のディレクトリへ移動します。

## ログファイル

各ツールはログファイルを出力します。  
出力先ディレクトリは`logs`です。  
ログファイルはJSON、名前は`${timestamp}_${tool name}_${sign}.json`の形式で出力します。

## 移動先ディレクトリ

`unique`、`comp`は、一部のファイルおよびシンボリックリンクを"移動先ディレクリ"へ移動することがあります。
"移動先ディレクトリ"は`extra`ディレクトリ以下に作成します。  
そのディレクトリ名の形式は`${timestamp}_${tool name}_${sign}`です。

## info

指定したディレクトリについて、以下を出力します。

* ファイル数
* シンボリックリンク数
* ファイルの拡張子とその拡張子を持つファイルの数
* シンボリックリンクの拡張子とその拡張子を持つシンボリックリンクの数

ファイルの拡張子は大文字で出力します。  
拡張子の長さが0の場合は`ext_zero.d`、拡張子が無い場合は`ext_none.d`として出力します。  

```
node info ${directory path} ${options}
```

### options

`${sign}`にはログファイルおよび抽出したファイルのディレクトリの名前に含みたい文字列を指定してください。  
指定した場合、ログファイル名は`${timestamp}_info_${sign}.json`になります。

```
-s ${sign}
```

## unique

対象ディレクトリ以下が単一のファイルのみになるよう、重複しているファイルおよびシンボリックリンクを"移動先ディレクトリ"へ移動します。  


```
node unique ${directory path} ${options}
```

"移動先ディレクトリ"以下には、名前がダイジェスト値であるディレクトリを作成し、そのディレクトリにファイルを移動します。  
移動後のファイル名の形式は`${no}_${btime}-${name}`です。  
`${no}`がすべて`0`ならばシンボリックリンクです。  

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。  

### options

`${sign}`にはログファイルおよび抽出したファイルのディレクトリの名前に含みたい文字列を指定してください。
指定した場合、ログファイル名は`${timestamp}_unique_${sign}.json`になります。
指定しなかった場合、ログファイルは`${sign}`の部分が指定したディレクトリ名の大文字になります。

```
-s ${sign}
```

重複しているファイルおよびシンボリックリンクを実際に移動する場合は指定してください。

```
-F
```

## extension

指定したディレクトリ以下に次のディレクトリを作成します。

* 拡張子を大文字にした名前のディレクトリ
* `ext_none.d`という名前のディレクトリ
* `ext_zero.d`という名前のディレクトリ

1文字以上の拡張子を持つファイルは、その拡張子を大文字にした名前のディレクトリに移動します。  
拡張子の長さが0のファイルは、`ext_zero.d`という名前のディレクトリに移動します。  
拡張子が無いファイルは、`ext_none.d`という名前のディレクトリに移動します。  

指定したディレクトリ以下に存在するディレクトリおよびシンボリックリンクは、"移動先ディレクトリ"以下の`extra.d`ディレクトリへ移動します。 

```
node extension ${directory path} ${options}
```

ファイルは`${no}_${btime}-${name}`という形式の名前になります。
`${no}`は`${btime}`が小さい順に`0`からの番号になります。

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。

### options

```
-s ${sign}
```

実際にファイルおよびシンボリックリンクを移動する場合は、`-F`を指定します。

```
-F
```

## comp

基準ディレクトリ以下のファイルと重複している対象ディレクトリ以下のファイルおよびすべてのシンボリックリンクを対象ディレクトリから移動します。  

```
node comp ${base directory path} ${target directory path} ${options}
```

なおファイルおよびシンボリックリンクを実際に移動するのは、`${options}`に`-F`が指定された場合です。

### options

```
-s ${sign}
```

実際にファイルおよびシンボリックリンクを移動する場合は、`-F`を指定します。

```
-F
```

## supply

対象ディレクトリ以下のファイルの内、基準ディレクトリ以下のファイルと不同のファイルを複製します。  
ファイルの複製先となるディレクトリはオプションで指定できます。

```
node supply ${base directory path} ${target directory path} ${options}
```

### options

実際にファイルを複製する場合は、`-F`を指定します。
```
-F
```

ファイルの複製先となるディレクトリを指定します。指定しなかった場合は移動先ディレクトリにファイルを複製します。

```
-dp ${directory path}
```

## header

指定したディレクトリ以下のファイルおよびシンボリックリンクのサイズと最初の数バイトを出力します。  
出力するバイト数は`${options}`で指定できます。`${options}`で指定しなかった場合は、10バイト以下になります。  

```
node header ${directory path} ${options}
```

### options

```
-s ${sign}
```

```
-n ${byte count}
```

## image

指定したディレクトリ以下に`BMP`、`GIF`、`JPG`、`PNG`と`binary.d`という名前のディレクトリを作成します。  
ファイルがBMPであれば`BMP`ディレクトリ、GIFであれば`GIF`ディレクトリに移動します。  
名前は`${no}_${btime}-${name}.${extension}`の形式になります。  
BMP、GIF、JPG、PNGのいずれでもないファイルは`binary.d`ディレクトリに移動します。  
名前は`${no}_${btime}-${name}`の形式になります。  

指定したディレクトリ以下のすべてのディレクトリとシンボリックリンクは"移動先ディレクトリ"の`extra.d`ディレクトリに移動します。  
```
node image ${directory path} ${options}
```

### options

```
-s ${sign}
```

```
-F
```

## date

指定したディレクトリ以下のファイルをファイル作成年月日ごとに分けます。
ファイル名の形式は`${no}_${btime}-${name}`になります。
指定したディレクトリ以下のディレクトリとシンボリックリンクは"移動先ディレクトリ"の`extra.d`ディレクトリに移動します。

```
node date ${directory path} ${options}
```

### options

```
-s ${sign}
```

```
-F
```

```
-d y
-d ym
-d ymd
```
ファイルの移動先は、ファイル名の`${btime}`が`20120304XXXXXXXXX`である場合、`y`ならば`2012`、`ym`ならば`2021-03`、`ymd`ならば`2021-03-04`という名前のディレクトリ以下になります。

## size

指定したディレクトリ以下のファイルを画像か画像でないかで分け、画像である場合はさらにサイズで分けます。  

画像のディレクトリ名は`${width}_${height}`になります。  
なお画像の横サイズより縦サイズが大きい場合は、横サイズと縦サイズを入れ替えて分けます。  
例えば横サイズが10で縦サイズが100ならば、"100_10"ディレクトリに分けられます。  
非画像のディレクトリ名は`other.d`になります。  
指定したディレクトリ以下に存在していたシンボリックリンクおよびディレクトリは、"移動先ディレクトリ"以下の`extra.d`ディレクトリに移動します。

```
node size ${directory path} ${options}
```

### options

```
-s ${sign}
```

```
-F
```

## copy

指定したディレクトリ以下のファイルを複製先ディレクトリ以下にディレクトリごと複製します。
なお複製するファイルは拡張子および画像の種類（BMP、GIF、JPG、PNG）を指定することができます。

```
node copy ${directory path} ${destination directory path} ${options}
```

### options

```
-s ${sign}
```

実際にファイルを複製する場合は指定します。

```
-F
```

`${extension}`には複製対象とするファイルの拡張子を指定します。
拡張子が無いファイルを複製したい場合は`ext_none.d`、拡張子の長さが0のファイルを複製したい場合は`ext_zero.d`を指定します。

```
-e ${extension}
```

`${image type}`には`bmp`、`gif`、`jpg``、png`を指定できます。
`bmp`、`gif`、`jpg`、`png`以外を指定した場合は、すべてのファイルを複製します。

```
-i ${image type}
```

## move

指定したディレクトリ以下のファイルを移動先ディレクトリ以下にディレクトリごと移動します。
なお移動するファイルは拡張子および画像の種類（BMP、GIF、JPG、PNG）を指定することができます。

```
node move ${directory path} ${destination directory path} ${options}
```

### options

```
-s ${sign}
```

実際にファイルを移動する場合は指定します。

```
-F
```

`${extension}`には移動対象とするファイルの拡張子を指定します。
拡張子が無いファイルを移動したい場合は`ext_none.d`、拡張子の長さが0のファイルを移動したい場合は`ext_zero.d`を指定します。

```
-e ${extension}
```

`${image type}`には`bmp`、`gif`、`jpg``、png`を指定できます。
`bmp`、`gif`、`jpg`、`png`以外を指定した場合は、すべてのファイルを移動します。

```
-i ${image type}
```
